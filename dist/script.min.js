"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var app=app||{common:{},pages:{}};function init(){var e=$("body").attr("id");app.pageInstance=new app.pages[e],app.common.commonInit(),app.pageInstance.init()}$(init),app.common.Accordion=function(){function t(e){_classCallCheck(this,t),this.animationTime=e,this.openedFrame=void 0,this.lastClosedFrameParentId=void 0}return _createClass(t,[{key:"init",value:function(){this.setEvents()}},{key:"setEvents",value:function(){$(".ac-q").on("click",this.accordionAnnimation.bind(this)),$(window).on("resize",this.refreshOpenedFrame.bind(this))}},{key:"accordionAnnimation",value:function(e){$(".ac-q").off("click");var t=$(e.target).parent().attr("id");this.openedFrame&&this.closeAccordion(),t!=this.lastClosedFrameParentId&&this.openAccordion(e,t),this.lastClosedFrameParentId=void 0,setTimeout(this.setEvents.bind(this),this.animationTime)}},{key:"openAccordion",value:function(e,t){var n=$("#".concat(t," > .ac-a")),a=$("#".concat(t," > .ac-a")).css("height","auto").height();n.css("height","0"),n.animate({height:a},this.animationTime),this.openedFrame=n}},{key:"closeAccordion",value:function(){this.openedFrame.animate({height:0},this.animationTime),this.lastClosedFrameParentId=this.openedFrame.parent().attr("id"),this.openedFrame=void 0}},{key:"refreshOpenedFrame",value:function(){var e=this.openedFrame.css("height","auto").height();this.openedFrame.animate({height:e},0)}}]),t}(),app.common.commonInit=function(){app.common.scrolling.setSmoothScrolling()},app.common.FormManager=function(){function o(e,t,n,a){_classCallCheck(this,o),this.formData=e,this.errorMessages=t,this.formId=n,this.url=a,this.regex={name:/^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/,phone:/((?:\+|00)[17](?: |\-)?|(?:\+|00)[1-9]\d{0,2}(?: |\-)?|(?:\+|00)1\-\d{3}(?: |\-)?)?(0\d|\([0-9]{3}\)|[1-9]{0,3})(?:((?: |\-)[0-9]{2}){4}|((?:[0-9]{2}){4})|((?: |\-)[0-9]{3}(?: |\-)[0-9]{4})|([0-9]{7}))/,mail:/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/},this.minNameLenth=3}return _createClass(o,[{key:"formValidator",value:function(){this.getFormData(),this.checkFormData()||this.sendData()}},{key:"getFormData",value:function(){var t=this,e=$(this.formId).serializeArray();this.formData.Q4=[],e.forEach(function(e){"Q4"===e.name?t.formData[e.name].push(e.value):t.formData[e.name]=e.value})}},{key:"checkFormData",value:function(){var n=this,a=!1;return $.each(this.formData,function(e,t){if(""===t||0===t.length)a=!0,"Q1"===e||"Q2"===e||"Q3"===e||"Q4"===e||"Acceptation"===e?n.setError(e,"click"):n.setError(e,"keyup");else{if("LastName"===e||"FirstName"===e)(!n.regex.name.test(n.formData[e])||n.formData[e].length<n.minNameLenth)&&(n.setError(e,"keyup"),a=!0);if("Phone"===e)n.regex.phone.test(n.formData[e])||(n.setError(e,"keyup"),a=!0);if("Mail"===e)n.regex.mail.test(n.formData[e])||(n.setError(e,"keyup"),a=!0)}}),app.pageInstance.accordion.refreshOpenedFrame(),a}},{key:"setError",value:function(t,e){var n=this;$("#".concat(t,"Container .error-message")).html(this.errorMessages[t]),$("input[name=".concat(t,"]")).on(e,function(e){n.checkInputData(e,t)})}},{key:"unsetError",value:function(e,t){$("#".concat(e,"Container .error-message")).html(""),app.pageInstance.accordion.refreshOpenedFrame(),$("input[name=".concat(e,"]")).off(t)}},{key:"checkInputData",value:function(e,t){var n=$(e.target).val();if("keyup"===e.type){if("LastName"===t||"FirstName"===t)this.regex.name.test(n)&&n.length>=this.minNameLenth&&this.unsetError(t,"keyup");if("Phone"===t)this.regex.phone.test(n)&&this.unsetError(t,"keyup");if("Mail"===t)this.regex.mail.test(n)&&this.unsetError(t,"keyup")}else this.unsetError(t,"click")}},{key:"sendData",value:function(){var n=new FormData;$.each(this.formData,function(e,t){n.append(e,t)});var e={method:"POST",body:n};fetch(this.url,e).then(function(e){return e.text()}).then(function(e){console.log(e),"mail sent"===e?($("#ThirdSlideBox .section-contents").css("display","none"),$("#Home .home-section-3 .form-answer").css("display","block"),app.pageInstance.accordion.refreshOpenedFrame()):console.log("no mail sent")})}}]),o}(),app.common.scrolling={setSmoothScrolling:function(){document.querySelectorAll('a[href^="#"]').forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),document.querySelector(this.getAttribute("href")).scrollIntoView({behavior:"smooth"})})})},scrollTo:function(e,t,n){setTimeout(function(){$([document.documentElement,document.body]).animate({scrollTop:$("#".concat(e)).offset().top},t)},n)}},app.pages.Home=function(){function e(){_classCallCheck(this,e),this.formData={Q1:"",Q2:"",Q3:"",Q4:[],LastName:"",FirstName:"",Phone:"",Mail:"",Acceptation:""},this.errorMessages={Q1:"Faites un choix",Q2:"Faites un choix",Q3:"Faites un choix",Q4:"Faites un choix",LastName:"Vous devez indiquer votre nom",FirstName:"Vous devez indiquer votre prénom",Phone:"Vous devez indiquer votre numéro de téléphone",Mail:"Vous devez indiquer votre adresse mail",Acceptation:"Acceptez les conditions générales d'utilisation"},this.url="assets/phpParts/pages/home/home-form-request.php"}return _createClass(e,[{key:"init",value:function(){this.accordion=new app.common.Accordion(500),this.formManager=new app.common.FormManager(this.formData,this.errorMessages,"#HomeForm",this.url),this.accordion.init(),this.setEvents()}},{key:"setEvents",value:function(){var t=this;$("#HomeSubmit").on("click",function(e){e.preventDefault(),t.formManager.formValidator()})}}]),e}();
//# sourceMappingURL=maps/script.min.js.map
