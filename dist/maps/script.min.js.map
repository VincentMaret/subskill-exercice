{"version":3,"sources":["main.js","common/accordion.js","common/common-init.js","common/form-manager.js","common/scrolling.js","pages/home.js"],"names":["app","common","pages","init","pageId","$","attr","pageInstance","commonInit","Accordion","_class","animationTime","_classCallCheck","this","openedFrame","undefined","lastClosedFrameParentId","isAnimated","_createClass","key","value","setEvents","on","accordionAnnimation","bind","window","refreshOpenedFrame","e","parentId","target","parent","closeAccordion","openAccordion","t","askedFrame","concat","autoHeight","css","height","animate","scrolling","setSmoothScrolling","REGEX","name","phone","mail","MIN_LENGTH","FormManager","_class2","formData","formId","url","errorCallback","mailCallback","getFormData","checkFormData","sendData","_this","formValues","serializeArray","each","i","x","_typeof","val","forEach","push","_this2","errorChecker","length","type","setError","regex","test","messageIndex","targetValue","unsetError","_this3","html","errorMsg","checkInputData","off","fd","FormData","append","options","method","body","fetch","then","res","text","data","console","log","document","querySelectorAll","anchor","addEventListener","preventDefault","querySelector","getAttribute","scrollIntoView","behavior","scrollTo","elId","time","delay","setTimeout","documentElement","scrollTop","offset","top","Home","_class3","Q1","Q2","Q3","Q4","LastName","FirstName","Phone","Mail","Acceptation","accordion","formManager","_this4","validateFormAndSendMail"],"mappings":"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","file":"../script.min.js","sourcesContent":["\r\n\r\nconst app = app || {\r\n  common: {},\r\n  pages: {}\r\n};\r\n\r\n$(init);\r\n\r\nfunction init() {\r\n  const pageId = $('body').attr('id');\r\n  app.pageInstance = new app.pages[pageId]();\r\n\r\n  app.common.commonInit();\r\n  app.pageInstance.init();\r\n}","app.common.Accordion = class {\r\n  constructor(animationTime) {\r\n    this.animationTime = animationTime;\r\n    this.openedFrame = undefined;\r\n    this.lastClosedFrameParentId = undefined;\r\n    this.isAnimated = false;\r\n  }\r\n\r\n  init() {\r\n    this.setEvents();\r\n  }\r\n  setEvents() {\r\n    $('.ac-q').on('click', this.accordionAnnimation.bind(this));\r\n    $(window).on('resize', this.refreshOpenedFrame.bind(this));\r\n  }\r\n  accordionAnnimation(e) {\r\n    if (this.isAnimated) { return; }\r\n    this.isAnimated = true;\r\n\r\n    const parentId = $(e.target).parent().attr('id');\r\n\r\n    if (this.openedFrame) { this.closeAccordion(); }\r\n\r\n    if (parentId != this.lastClosedFrameParentId) {\r\n      this.openAccordion(e, parentId);\r\n      //app.common.scrolling.scrollTo(parentId, 200, this.animationTime);\r\n    }\r\n    this.lastClosedFrameParentId = undefined;\r\n  }\r\n  openAccordion(e, parentId) {\r\n    const t = this;\r\n    const askedFrame = $(`#${parentId} > .ac-a`);\r\n    const autoHeight = $(`#${parentId} > .ac-a`).css('height', 'auto').height();\r\n    askedFrame.css('height', '0');\r\n    askedFrame.animate({\r\n      height: autoHeight\r\n    }, this.animationTime, () => { t.isAnimated = false; });\r\n    this.openedFrame = askedFrame;\r\n  }\r\n  closeAccordion() {\r\n    const t = this;\r\n    this.openedFrame.animate({\r\n      height: 0\r\n    }, this.animationTime, () => { t.isAnimated = false; });\r\n    this.lastClosedFrameParentId = this.openedFrame.parent().attr('id');;\r\n    this.openedFrame = undefined;\r\n  }\r\n\r\n  refreshOpenedFrame() {\r\n    if (this.openedFrame) {\r\n      const autoHeight = this.openedFrame.css('height', 'auto').height();\r\n      this.openedFrame.animate({\r\n        height: autoHeight\r\n      }, 0);\r\n    }\r\n  }\r\n}","app.common.commonInit = () => {\r\n  app.common.scrolling.setSmoothScrolling();\r\n}","const REGEX = {\r\n  name: /^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/,\r\n  // Support wide range of phone number format\r\n  phone: /((?:\\+|00)[17](?: |\\-)?|(?:\\+|00)[1-9]\\d{0,2}(?: |\\-)?|(?:\\+|00)1\\-\\d{3}(?: |\\-)?)?(0\\d|\\([0-9]{3}\\)|[1-9]{0,3})(?:((?: |\\-)[0-9]{2}){4}|((?:[0-9]{2}){4})|((?: |\\-)[0-9]{3}(?: |\\-)[0-9]{4})|([0-9]{7}))/,\r\n  mail: /^([a-z0-9\\+_\\-]+)(\\.[a-z0-9\\+_\\-]+)*@([a-z0-9\\-]+\\.)+[a-z]{2,6}$/\r\n};\r\nconst MIN_LENGTH = 3;\r\n\r\napp.common.FormManager = class {\r\n  constructor(formData, formId, url, errorCallback) {\r\n    this.formData = formData;\r\n    this.formId = formId;\r\n    this.url = url;\r\n    this.errorCallback = errorCallback;\r\n  }\r\n\r\n  validateFormAndSendMail(mailCallback) {\r\n    this.getFormData();\r\n\r\n    const hasError = this.checkFormData();\r\n    if (!hasError) {\r\n      this.sendData(mailCallback);\r\n    }\r\n  }\r\n\r\n  getFormData() {\r\n    const formValues = $(this.formId).serializeArray();\r\n    const t = this;\r\n\r\n    // reset form data arrays\r\n    $.each(this.formData, (i, x) => {\r\n      if (typeof x.val === 'object') {\r\n        t.formData[i].val = [];\r\n      }\r\n    });\r\n\r\n    formValues.forEach(x => {\r\n      // if values are store in object\r\n      if (typeof this.formData[x.name].val === 'object') {\r\n        this.formData[x.name].val.push(x.value);\r\n      }\r\n      else { this.formData[x.name].val = x.value; }\r\n    });\r\n  }\r\n  checkFormData() {\r\n    let errorChecker = false;\r\n\r\n    $.each(this.formData, (i, x) => {\r\n      // if no value set\r\n      if (x.val === \"\" || x.val.length === 0) {\r\n        errorChecker = true;\r\n\r\n        // if checkbox\r\n        if (x.type === 'checkbox') {\r\n          this.setError(i, 'click');\r\n        } else {\r\n          this.setError(i, 'keyup');\r\n        }\r\n      } else {\r\n        if (x.type === 'text') {\r\n          const test = REGEX[x.regex].test(x.val);\r\n\r\n          // if don't match regex or value too short\r\n          if (!test || x.val.length < MIN_LENGTH) {\r\n            this.setError(i, 'keyup');\r\n            errorChecker = true;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    // launch error callback\r\n    if (this.errorCallback) { this.errorCallback(); }\r\n\r\n    return errorChecker;\r\n  }\r\n  // check single data\r\n  checkInputData(e, messageIndex) {\r\n    const targetValue = $(e.target).val();\r\n    // if txt box message\r\n    if (e.type === 'keyup') {\r\n\r\n      const test = REGEX[this.formData[messageIndex].regex].test(targetValue);\r\n      // if match name regex and require length\r\n      if (test && targetValue.length >= MIN_LENGTH) {\r\n        this.unsetError(messageIndex, 'keyup');\r\n      }\r\n\r\n    } else {\r\n      this.unsetError(messageIndex, 'click');\r\n    }\r\n  }\r\n\r\n  setError(messageIndex, type) {\r\n    // write message\r\n    $(`#${messageIndex}Container .error-message`).html(this.formData[messageIndex].errorMsg);\r\n    // set event to remove it\r\n    $(`input[name=${messageIndex}]`).on(type, e => {\r\n      this.checkInputData(e, messageIndex);\r\n    });\r\n  }\r\n  unsetError(messageIndex, type) {\r\n    // write empty message\r\n    $(`#${messageIndex}Container .error-message`).html('');\r\n    // launch error callback\r\n    if (this.errorCallback) { this.errorCallback(); }\r\n    // unset event\r\n    $(`input[name=${messageIndex}]`).off(type);\r\n  }\r\n\r\n  sendData(mailCallback) {\r\n    const fd = new FormData();\r\n    const t = this;\r\n\r\n    $.each(this.formData, (i, x) => {\r\n      fd.append(i, x.val);\r\n    });\r\n\r\n    const options = {\r\n      method: 'POST',\r\n      body: fd\r\n    }\r\n    const sendRes = fetch(this.url, options);\r\n    sendRes.then(res => res.text())\r\n      .then(data => {\r\n        console.log(data);\r\n        mailCallback(data);\r\n      });\r\n  }\r\n\r\n}","app.common.scrolling = {\r\n  // -----------------------------------------\r\n  setSmoothScrolling() {\r\n    document.querySelectorAll('a[href^=\"#\"]').forEach(anchor => {\r\n      anchor.addEventListener('click', function (e) {\r\n        e.preventDefault();\r\n\r\n        document.querySelector(this.getAttribute('href')).scrollIntoView({\r\n          behavior: 'smooth'\r\n        });\r\n      });\r\n    });\r\n  },\r\n  // -----------------------------------------\r\n  scrollTo(elId, time, delay) {\r\n    setTimeout(() => {\r\n      $([document.documentElement, document.body]).animate({\r\n        scrollTop: $(`#${elId}`).offset().top\r\n      }, time);\r\n    }, delay);\r\n\r\n  }\r\n}","app.pages.Home = class {\r\n  constructor() {\r\n    this.formData = {\r\n      Q1: { val: '', type: 'checkbox', errorMsg: 'Faites un choix' },\r\n      Q2: { val: '', type: 'checkbox', errorMsg: 'Faites un choix' },\r\n      Q3: { val: '', type: 'checkbox', errorMsg: 'Faites un choix' },\r\n      Q4: { val: [], type: 'checkbox', errorMsg: 'Faites un choix' },\r\n      LastName: { val: '', type: 'text', regex: 'name', errorMsg: 'Vous devez indiquer votre nom' },\r\n      FirstName: { val: '', type: 'text', regex: 'name', errorMsg: 'Vous devez indiquer votre prénom' },\r\n      Phone: { val: '', type: 'text', regex: 'phone', errorMsg: 'Vous devez indiquer votre numéro de téléphone' },\r\n      Mail: { val: '', type: 'text', regex: 'mail', errorMsg: 'Vous devez indiquer votre adresse mail' },\r\n      Acceptation: { val: '', type: 'checkbox', errorMsg: 'Acceptez les conditions générales d\\'utilisation' }\r\n    };\r\n    this.url = 'assets/phpParts/pages/home/home-form-request.php';\r\n  }\r\n  init() {\r\n    this.accordion = new app.common.Accordion(500);\r\n    this.formManager = new app.common.FormManager(this.formData, '#HomeForm', this.url, this.errorCallback);\r\n\r\n    this.accordion.init();\r\n    this.setEvents();\r\n  }\r\n\r\n  setEvents() {\r\n    const t = this;\r\n\r\n    $('#HomeSubmit').on('click', e => {\r\n      e.preventDefault();\r\n      t.formManager.validateFormAndSendMail(this.mailCallback);\r\n    });\r\n  }\r\n\r\n  mailCallback(data) {\r\n    if (data === 'mail sent') {\r\n      $('#ThirdSlideBox .section-contents').css('display', 'none');\r\n      $('#Home .home-section-3 .form-answer').css('display', 'block');\r\n      app.pageInstance.accordion.refreshOpenedFrame();\r\n    } else {\r\n      console.log('no mail sent');\r\n    }\r\n  }\r\n\r\n  errorCallback() {\r\n    app.pageInstance.accordion.refreshOpenedFrame();\r\n  }\r\n\r\n}"]}